<div id="tab-backtest" class="tab-content">
    <section class="card full-height" style="display: flex; flex-direction: column; padding: 20px; gap: 0;">

        <!-- 1. Config Section -->
        <div class="config-section"
            style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid var(--border);">
            <div class="section-header" style="display: flex; justify-content: space-between; align-items: center;">
                <h2>1. 백테스트 설정</h2>
                <a href="/manual/backtest_process" target="_blank" class="nav-link" style="font-size: 0.9em;">📄 상세 처리
                    과정</a>
            </div>
            <form id="backtest-form" class="config-grid">
                <div class="form-group">
                    <label>종목 코드</label>
                    <input type="text" id="bt-symbol" value="005930" placeholder="예: 005930">
                </div>
                <div class="form-group">
                    <label>시작일</label>
                    <input type="date" id="bt-start-date">
                </div>
                <div class="form-group">
                    <label>종료일</label>
                    <input type="date" id="bt-end-date">
                </div>
                <div class="form-group">
                    <label>초기 자본금</label>
                    <input type="number" id="bt-initial-cash" value="100000000" step="1000000">
                </div>
                <div class="form-group span-2">
                    <label>전략 선택</label>
                    <select id="bt-strategy-select">
                        <option value="" disabled selected>전략을 선택하세요</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" id="btn-check-data" class="btn-secondary">데이터 조회</button>
                    <button type="submit" id="btn-run-backtest" class="btn-primary" disabled>백테스트 실행</button>
                </div>
            </form>
        </div>

        <!-- 2. Results Section -->
        <div class="results-section"
            style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid var(--border);">
            <div class="section-header">
                <h2>2. 실행 결과</h2>
                <div id="bt-status" class="status-text">대기 중</div>
            </div>

            <div class="progress-container">
                <div class="progress-bar-bg">
                    <div id="bt-progress-bar" class="progress-bar-fill" style="width: 0%;"></div>
                </div>
                <span id="bt-progress-text">0%</span>
            </div>

            <div class="metric-group compact" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px;">
                <div class="metric">
                    <span class="label">수량</span>
                    <span class="value" id="bt-qty">0</span>
                </div>
                <div class="metric">
                    <span class="label">매입평균</span>
                    <span class="value" id="bt-avg">0</span>
                </div>
                <div class="metric">
                    <span class="label">매입금액</span>
                    <span class="value" id="bt-buy-amt">0</span>
                </div>
                <div class="metric">
                    <span class="label">평가금액</span>
                    <span class="value" id="bt-eval-amt">0</span>
                </div>
                <div class="metric">
                    <span class="label">평가손익</span>
                    <span class="value" id="bt-eval-pnl">0</span>
                </div>
                <div class="metric">
                    <span class="label">수익률</span>
                    <span class="value" id="bt-return-rate">0.00%</span>
                </div>
                <div class="metric">
                    <span class="label">매매횟수</span>
                    <span class="value" id="bt-trade-count">0</span>
                </div>
            </div>
        </div>

        <!-- 3. Logs Section -->
        <div class="logs-section" style="flex: 1; overflow: hidden; display: flex; flex-direction: column;">
            <div class="section-header">
                <h2>3. 데이터 및 매매 로그</h2>
                <div style="display: flex; gap: 5px;">
                    <a id="btn-download-excel" href="#" class="btn-secondary small-btn"
                        style="text-decoration: none;">엑셀 다운로드</a>
                    <button id="btn-view-chart" class="btn-secondary small-btn" style="display:none;">차트 보기</button>
                </div>
            </div>
            <div class="table-container-scroll" style="flex: 1; overflow-y: auto;">
                <table id="bt-trade-table" class="data-table">
                    <thead class="sticky-header">
                        <tr>
                            <!-- Base Data -->
                            <th>일시</th>
                            <th class="text-right">종가</th>
                            <th class="text-right">이평(5)</th>
                            <th class="text-right">이평(20)</th>
                            <th class="text-right">거래량</th>
                            <th class="text-right col-ma-trend" style="display:none;">평균거래량(20)</th>
                            <!-- Trade Info (Filled during execution) -->
                            <th class="border-left">매매유형</th>
                            <th class="text-right">수량</th>
                            <th class="text-right">체결가</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </section>
</div>