<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>안티-스톡 트레이딩 봇 - 사용 설명서</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f4f6f8;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent: #3b82f6;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        h1 {
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        h2 {
            margin-top: 30px;
            color: var(--accent);
        }

        h3 {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .config-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .config-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
            display: block;
        }

        .config-desc {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .config-example {
            font-size: 13px;
            color: #059669;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>안티-스톡 트레이딩 봇 사용 설명서</h1>

        <section class="card">
            <h2>시스템 제어 및 설정 방법</h2>
            <p>안티-스톡 트레이딩 봇의 제어 및 설정 변경 방법입니다.</p>

            <h3>제어 버튼</h3>
            <ul>
                <li><strong>시작</strong>: 봇이 중지된 상태일 때 트레이딩을 시작합니다.</li>
                <li><strong>재시작</strong>: 봇이 실행 중일 때 나타납니다. 변경된 설정을 적용하기 위해 봇을 재시작합니다. (설정 적용)</li>
                <li><strong>중지</strong>: 실행 중인 봇을 즉시 중지합니다. 모든 전략 실행이 멈춥니다.</li>
            </ul>

            <h3>설정 변경 워크플로우</h3>
            <ol>
                <li><strong>설정 변경 (자동 저장)</strong>: '시스템 설정'이나 '전략 설정'의 값을 변경하면 <strong>즉시 파일에 자동 저장</strong>됩니다. 별도의 저장
                    버튼은 없습니다.</li>
                <li><strong>설정 적용</strong>:
                    <ul>
                        <li><strong>실행 중일 때</strong>: 상단의 <strong>'재시작'</strong> 버튼을 누르면 변경된 설정으로 봇이 다시 시작됩니다.</li>
                        <li><strong>중지 상태일 때</strong>: <strong>'시작'</strong> 버튼을 누르면 변경된 설정으로 시작됩니다.</li>
                    </ul>
                </li>
            </ol>
        </section>

        <section class="card">
            <h2>시스템 상세 설정 (System Configuration)</h2>
            <p>웹 대시보드의 '환경 설정' 탭에서 변경할 수 있는 시스템 관련 옵션들입니다.</p>



            <div class="config-item">
                <span class="config-name">알림 설정 (Telegram Alert)</span>
                <p class="config-desc">텔레그램 봇으로 메시지를 받을지 여부를 선택합니다.</p>
                <ul>
                    <li><strong>매매 알림</strong>: 매수/매도 체결 시 알림 발송</li>
                    <li><strong>시스템 알림</strong>: 봇 시작/종료, 에러 발생 시 알림 발송</li>
                </ul>
            </div>
        </section>

        <section class="card">
            <h2>자동 매매 작동 프로세스 (How it Works)</h2>
            <p>시스템이 어떻게 종목을 찾고 매매하는지 구체적인 예시로 설명합니다.</p>

            <h3>작동 시나리오 예시 (삼성전자)</h3>
            <ol>
                <li><strong>1. 종목 포착 (Scanning)</strong>: <br>
                    스캐너가 시장 전체를 분석하여 거래량이 급증하거나 상위권에 랭크된 '삼성전자'를 발견하고 <strong>감시 리스트(Universe)</strong>에 등록합니다.
                </li>
                <li><strong>2. 실시간 감시 (Monitoring)</strong>: <br>
                    'MarketData' 엔진이 승인된 감시 종목들의 가격을 실시간으로 추적합니다. <br>
                    <em>로그 예시: <code>[감시 중] 005930 삼성전자 | ... | 추세: (정배열) | 거래량: (충족)</code></em>
                </li>
                <li><strong>3. 관심 종목 등극 (Interest)</strong>: <br>
                    일봉상 상승 추세(정배열)이면서, 분봉상 골든크로스가 임박했을 때 관심을 가집니다.
                </li>
                <li><strong>4. 매수 진입 (Buy Signal)</strong>: <br>
                    5분봉 차트에서 5일선이 20일선을 뚫고 올라가는 <strong>골든크로스</strong>가 발생하고 거래량이 충분하면 매수합니다.
                    <br><em>로그 예시: <code>[매수 진입] 005930 삼성전자 | 골든크로스(확정) ...</code></em>
                    <br>(단, 상승폭이 미미하면 <em><code>[진입 보류] ... (휩쏘 필터)</code></em> 로그가 표시되며 매수하지 않습니다.)
                </li>
            </ol>
        </section>

        <section class="card">
            <h2>감시종목 탭 사용 가이드 (Watchlist Tab)</h2>
            <p>실시간으로 시세를 모니터링하고 싶은 종목들을 관리하는 공간입니다.</p>
            <ul>
                <li><strong>좌우 3:7 분할</strong>: 좌측은 종목 검색 및 선택, 우측은 모니터링 리스트입니다.</li>
                <li><strong>종목 검색</strong>: 좌측 상단 입력창에 종목명이나 코드를 입력하여 빠르게 찾을 수 있습니다.</li>
                <li><strong>스파크라인 (Sparkline)</strong>: 각 종목의 최근 30일간 주가 흐름을 미니 차트로 한눈에 파악할 수 있습니다.</li>
                <li><strong>데이터 업데이트</strong>: 우측 리스트의 데이터(현재가, 등락률 등)는 탭이 활성화되어 있을 때 5초마다 자동으로 갱신됩니다.</li>
            </ul>
        </section>

        <section class="card">
            <h2>차트 팝업 사용 가이드 (Chart Popup)</h2>
            <p>메인 화면의 <strong>'감시종목'</strong> 탭에서 종목명을 클릭하면 해당 종목의 상세 차트 팝업이 열립니다.</p>

            <h3>1. 팝업 제어</h3>
            <ul>
                <li><strong>시간 단위 (Timeframe)</strong>: 상단의 버튼을 눌러 차트 주기를 변경합니다. (1분, 3분, 5분, 15분, 일봉)</li>
                <li><strong>이동평균선 (MA)</strong>: 상단의 체크박스로 5, 10, 20, 60, 120, 200일 이평선을 켜고 끌 수 있습니다.</li>
                <li><strong>닫기</strong>: 우측 상단의 'X' 버튼을 누르면 팝업이 닫힙니다.</li>
            </ul>

            <h3>2. 차트 기능</h3>
            <ul>
                <li><strong>캔들 차트</strong>: 시가, 고가, 저가, 종가를 캔들 형태로 표시합니다.</li>
                <li><strong>거래량 (Volume)</strong>: 차트 하단에 막대 그래프로 표시됩니다.</li>
                <li><strong>줌/팬 (Zoom/Pan)</strong>: 마우스 휠로 확대/축소, 드래그로 차트 이동이 가능합니다.</li>
            </ul>

            <h3>3. 매매 마커 (Trade Markers)</h3>
            <p>봇이 매매를 체결한 내역이 차트 위에 자동으로 표시됩니다.</p>
            <ul>
                <li><strong>매수 (Buy)</strong>: 캔들 아래에 <span style="color: green;">▲</span> 초록색 화살표로 표시됩니다.</li>
                <li><strong>매도 (Sell)</strong>: 캔들 위에 <span style="color: red;">▼</span> 빨간색 화살표로 표시됩니다.</li>
            </ul>
        </section>

        <section class="card">
            <h2>시스템 로그 (System Logs)</h2>
            <p>시스템의 작동 상태, 에러 메시지, 트레이딩 체결 내역 등을 텍스트로 확인하는 공간입니다.</p>

            <h3>1. 화면 표시 제한 (Display Limit)</h3>
            <ul>
                <li><strong>최근 1,000줄만 표시</strong>: 웹 브라우저 성능 저하를 방지하기 위해, 로그 탭 화면에는 <strong>최근 1,000개의 로그</strong>만
                    유지됩니다.</li>
                <li><strong>오래된 로그 자동 삭제</strong>: 새로운 로그가 계속 쌓이면 가장 오래된 로그는 화면에서 자동으로 사라집니다.</li>
            </ul>

            <h3>2. 로그 다운로드 (Log Download)</h3>
            <ul>
                <li><strong>전체 파일 다운로드</strong>: '로그 다운로드' 버튼은 화면에 보이는 내용이 아닌, 서버에 저장된 <strong>전체 원본 로그
                        파일(anti_stock.log)</strong>을 다운로드합니다.</li>
                <li><strong>과거 기록 확인</strong>: 화면에서 사라진 오래된 기록이나 며칠 전의 로그는 다운로드한 파일에서 모두 확인할 수 있습니다.</li>
            </ul>
        </section>

        <section class="card">
            <h2>감시 제외 조건 (Monitoring Exclusions)</h2>
            <p>로그에 <code>[감시 제외]</code> 메시지가 뜨는 것은 오류가 아니라, 봇이 필터링을 수행하고 있다는 정상적인 신호입니다.</p>

            <div class="config-item">
                <span class="config-name">하락 추세 (주가 < 20일선)</span>
                        <p class="config-desc">현재 주가가 20일 이동평균선(생명선) 아래에 있어, 중기 추세가 하락세인 경우입니다. 역배열 종목은 승률이 낮아 단타 대상에서
                            제외합니다.</p>
            </div>

            <div class="config-item">
                <span class="config-name">20일선 하락 중</span>
                <p class="config-desc">주가는 20일선 위에 있지만, 20일선 자체가 꺾여서 내려가고 있는 경우입니다. 상승 탄력이 약화된 상태로 판단합니다.</p>
            </div>

            <div class="config-item">
                <span class="config-name">전일 거래량 부족</span>
                <p class="config-desc">어제(D-1)의 거래량이 평소(20일 평균)보다 1.5배 이상 터지지 않은 경우입니다. '거래량이 터진 다음 날의 눌림목'을 공략하는 전략
                    특성상, 기준에 미달하여 제외합니다.</p>
            </div>
        </section>

        <section class="card">
            <h2>대상 종목 선정 (Target Stock Selection)</h2>
            <p>봇이 거래할 종목을 선정하는 두 가지 방법이 있습니다.</p>

            <h3>1. 감시종목 탭 이용 (Watchlist)</h3>
            <p>메인 화면의 <strong>'감시종목'</strong> 탭에서 관심 있는 종목을 검색하고 리스트에 추가합니다. 이 리스트에 추가된 종목들은 시스템이 실시간으로 시세를 감시하며, 자동 매매의
                대상 후보군이 됩니다.</p>
            <ul>
                <li><strong>종목 추가</strong>: 좌측 패널에서 종목명/코드를 검색하고 선택한 뒤 '추가' 버튼을 누릅니다.</li>
                <li><strong>증권사 가져오기</strong>: '증권사 가져오기' 버튼을 통해 HTS/MTS에 저장된 관심종목 그룹을 한 번에 불러올 수 있습니다.</li>
                <li><strong>자동 저장</strong>: '저장' 버튼을 누르면 리스트가 영구 저장되어 재시작 후에도 유지됩니다.</li>
            </ul>

            <h3>2. 자동 선정 (Auto-Scanner)</h3>
            <p>시장 상황에 따라 거래량이 터지거나 급등하는 종목을 봇이 자동으로 찾아냅니다. 이 기능을 켜면 수동 지정한 종목은 무시됩니다.</p>
            <div class="config-item">
                <span class="config-name">use_auto_scanner</span>
                <p class="config-desc">자동 선정 기능 사용 여부입니다. (true/false)</p>
            </div>
            <div class="config-item">
                <span class="config-name">scanner_mode</span>
                <p class="config-desc">종목 선정 기준입니다.</p>
                <ul>
                    <li><code>volume</code>: 거래량 상위 종목 (단타/스캘핑에 유리)</li>
                    <li><code>gainers</code>: 등락률 상위 종목 (급등주 공략에 유리)</li>
                </ul>
            </div>
        </section>

        <h2>공통 설정 (Common)</h2>
        <div class="config-item">
            <span class="config-name">entry_start_time</span>
            <p class="config-desc">매수 진입 허용 시작 시간입니다. 장 시작 시 초반 변동성을 피하기 위해 사용합니다. (HHMMSS)</p>
            <p class="config-example">예시: "091000" (09시 10분 00초부터 매수 진입 시작)</p>
        </div>
        <div class="config-item">
            <span class="config-name">max_positions</span>
            <p class="config-desc">동시에 보유할 수 있는 최대 종목 수입니다.</p>
            <p class="config-example">예시: 10 (최대 10개 종목 보유)</p>
        </div>
        <div class="config-item">
            <span class="config-name">risk_pct</span>
            <p class="config-desc">한 번 매수 진입 시 주문할 비중(Step)입니다.</p>
            <p class="config-example">예시: 0.03 (한 번에 3%씩 진입)</p>
        </div>
        <div class="config-item">
            <span class="config-name">target_weight</span>
            <p class="config-desc">종목당 최종 목표 비중입니다. 이 비율이 될 때까지 계속 감시하며 추가 매수합니다.</p>
            <p class="config-example">예시: 0.10 (자산의 10%까지 풀매수 목표)</p>
        </div>
        <div class="config-item">
            <span class="config-name">trail_activation_pct</span>
            <p class="config-desc">트레일링 스탑이 발동되는 수익률입니다.</p>
            <p class="config-example">예시: 0.03 (3%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">whipsaw_threshold</span>
            <p class="config-desc">휩쏘 방지 임계값입니다. 장기 이동평균선 대비 주가가 최소 이 비율만큼 높아야 진입합니다. (거짓 신호 필터링)</p>
            <p class="config-example">예시: 0.002 (0.2%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">cross_lookback</span>
            <p class="config-desc">골든크로스 유효 기간입니다. 크로스가 발생한 후 지정된 봉(Candle) 개수 동안은 거래량이 뒤늦게 터져도 매수 진입을 허용합니다.</p>
            <p class="config-example">예시: 3 (3봉 이내 유효)</p>
        </div>
        <div class="config-item">
            <span class="config-name">prev_daily_vol_k</span>
            <p class="config-desc">일봉 상대 거래량 필터입니다. 전일 거래량이 "전일 기준 20일 평균 거래량"의 K배 이상이어야만 진입합니다.</p>
            <p class="config-example">예시: 1.5 (평소보다 1.5배 이상 거래량 폭증 시에만 진입)</p>
        </div>

        <h2>이동평균 추세 추종 (MA Trend)</h2>
        <p>일봉상 상승 추세인 종목에서 분봉상 골든크로스가 발생할 때 매수하는 정석적인 추세 추종 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입 (Buy)</strong>: 다음 4박자가 모두 맞아야 진입합니다.
                <ol>
                    <li><strong>일봉 추세</strong>: 정배열 (주가 > 20일선) + 20일선 우상향 + 전일 거래량 폭발</li>
                    <li><strong>추세 강도</strong>: ADX 지표 25 이상 (횡보장 필터링)</li>
                    <li><strong>기울기</strong>: 20일 이동평균선의 기울기가 양수(+)</li>
                    <li><strong>손익비 (RR)</strong>: 기대 수익이 손절폭의 2.0배~3.0배 이상 나오는 자리</li>
                </ol>
                이 상태에서 5분봉상 <strong>골든크로스</strong> 발생 시 매수합니다. (<strong>성과 가중치</strong> 적용 시 비중 확대)
            </li>
            <li><strong>청산 (Sell)</strong>:
                <ol>
                    <li><strong>1차 익절 (Partial TP)</strong>: 수익률이 <code>take_profit1_pct</code> (예: 0.05 / 5%) 도달 시 50%
                        분할 매도.</li>
                    <li><strong>트레일링 스탑 (Trailing Stop)</strong>: 고점 대비 <code>trail_stop_pct</code> (예: 1.5%) 하락 시 전량 매도
                        (수익 보존).</li>
                    <li><strong>손절 (Stop Loss)</strong>: 수익률이 <code>-stop_loss_pct</code> (예: -3%) 도달 시 즉시 전량 매도.</li>
                </ol>
            </li>
        </ul>

        <div class="config-item">
            <span class="config-name">timeframe</span>
            <p class="config-desc">차트의 시간 단위입니다. (1m, 3m, 5m, 15m, 30m, 1h, 1d)</p>
            <p class="config-example">예시: 5m (5분봉)</p>
        </div>
        <div class="config-item">
            <span class="config-name">vol_k</span>
            <p class="config-desc">평균 거래량 대비 급증 배수입니다.</p>
            <p class="config-example">예시: 1.5 (1.5배 이상)</p>
        </div>

        <div class="config-item">
            <span class="config-name">ma_short</span>
            <p class="config-desc">단기 이동평균선 기간입니다.</p>
            <p class="config-example">예시: 5 (5일선)</p>
        </div>
        <div class="config-item">
            <span class="config-name">ma_long</span>
            <p class="config-desc">장기 이동평균선 기간입니다.</p>
            <p class="config-example">예시: 20 (20일선)</p>
        </div>
        <div class="config-item">
            <span class="config-name">stop_loss_pct</span>
            <p class="config-desc">손절매 기준 수익률입니다.</p>
            <p class="config-example">예시: 0.02 (2%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">trail_activation_pct</span>
            <p class="config-desc">트레일링 스탑 발동 기준 수익률입니다. 이 수익률에 도달해야 고점 대비 하락 감시가 시작됩니다.</p>
            <p class="config-example">예시: 0.03 (3%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">trail_stop_pct</span>
            <p class="config-desc">트레일링 스탑 기준 비율입니다. 고점(발동 이후) 대비 이만큼 하락하면 이익 실현합니다.</p>
            <p class="config-example">예시: 0.015 (1.5%)</p>
        </div>

        <h2>볼린저 밴드 평균 회귀 (Bollinger MR)</h2>
        <p>주가가 볼린저 밴드 하단을 이탈했을 때 과매도로 판단하여 매수하고, 평균(중심선)으로 회귀할 때 매도하는 역추세 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 현재가가 볼린저 밴드 하단(Lower Band)의 99% 수준보다 낮아질 때 (밴드 이탈).</li>
            <li><strong>청산</strong>: 중심선(20이평) 위로 올라오면 익절, 또는 손절(-stop_loss_pct) 발생 시.</li>
        </ul>
        <div class="config-item">
            <span class="config-name">timeframe</span>
            <p class="config-desc">차트의 시간 단위입니다.</p>
            <p class="config-example">예시: 15m (15분봉)</p>
        </div>
        <div class="config-item">
            <span class="config-name">period</span>
            <p class="config-desc">볼린저 밴드의 기준 이동평균선 기간입니다.</p>
            <p class="config-example">예시: 20</p>
        </div>
        <div class="config-item">
            <span class="config-name">std_dev</span>
            <p class="config-desc">볼린저 밴드 표준편차 승수입니다.</p>
            <p class="config-example">예시: 2</p>
        </div>
        <div class="config-item">
            <span class="config-name">risk_pct</span>
            <p class="config-desc">진입 시 자산 대비 리스크 비율입니다.</p>
            <p class="config-example">예시: 0.03 (3%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">timeframe</span>
            <p class="config-desc">차트의 시간 단위입니다.</p>
            <p class="config-example">예시: 1m (1분봉)</p>
        </div>
        <div class="config-item">
            <span class="config-name">stop_loss_pct</span>
            <p class="config-desc">손절매 기준 수익률입니다.</p>
            <p class="config-example">예시: 0.015 (1.5%)</p>
        </div>

        <h2>전고점 돌파 (Breakout)</h2>
        <p>전일 고점을 강하게 돌파하는 종목을 매수하여 단기 상승 추세를 추종하는 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 시가 갭 상승, 전일 고점 돌파, 거래량 급증(평균의 vol_k배) 3박자가 맞을 때.</li>
            <li><strong>청산</strong>: 전일 고점 아래로 다시 하락하거나 손절(-stop_loss_pct) 시 즉시 매도. 목표 수익(take_profit1_pct) 도달 시 절반
                익절.
            </li>
        </ul>
        <div class="config-item">
            <span class="config-name">timeframe</span>
            <p class="config-desc">차트의 시간 단위입니다.</p>
            <p class="config-example">예시: 1m (1분봉)</p>
        </div>
        <div class="config-item">
            <span class="config-name">gap_pct</span>
            <p class="config-desc">시가 갭 상승 최소 비율입니다.</p>
            <p class="config-example">예시: 2.0 (2% 이상)</p>
        </div>
        <div class="config-item">
            <span class="config-name">vol_k</span>
            <p class="config-desc">거래량 급증 기준입니다.</p>
            <p class="config-example">예시: 2.0 (2배 이상)</p>
        </div>
        <div class="config-item">
            <span class="config-name">stop_loss_pct</span>
            <p class="config-desc">손절매 기준 수익률입니다.</p>
            <p class="config-example">예시: 2.0 (2%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">take_profit1_pct</span>
            <p class="config-desc">1차 익절(절반 매도) 기준 수익률입니다.</p>
            <p class="config-example">예시: 3.0 (3%)</p>
        </div>

        <h2>VWAP 스캘핑 (VWAP Scalping)</h2>
        <p>거래량 가중 평균 가격(VWAP)을 지지선/저항선으로 활용하여, 주가가 VWAP를 상향 돌파할 때 매수하는 단타 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 주가가 VWAP 선을 아래에서 위로 뚫고 올라갈 때 (Cross Up).</li>
            <li><strong>청산</strong>: 주가가 다시 VWAP 아래로 떨어지면 즉시 매도(손절/이탈), 또는 목표 수익(take_profit_pct) 도달 시 익절.</li>
        </ul>
        <div class="config-item">
            <span class="config-name">timeframe</span>
            <p class="config-desc">차트의 시간 단위입니다.</p>
            <p class="config-example">예시: 1m (1분봉)</p>
        </div>
        <div class="config-item">
            <span class="config-name">risk_pct</span>
            <p class="config-desc">스캘핑 전략 전용 리스크 비율입니다.</p>
            <p class="config-example">예시: 0.01 (1%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">take_profit_pct</span>
            <p class="config-desc">목표 수익률입니다.</p>
            <p class="config-example">예시: 1.5 (1.5%)</p>
        </div>
    </div>
</body>

</html>