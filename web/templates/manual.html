<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>안티-스톡 트레이딩 봇 - 사용 설명서</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f4f6f8;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent: #3b82f6;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        h1 {
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        h2 {
            margin-top: 30px;
            color: var(--accent);
        }

        h3 {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .config-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .config-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
            display: block;
        }

        .config-desc {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .config-example {
            font-size: 13px;
            color: #059669;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>안티-스톡 트레이딩 봇 사용 설명서</h1>

        <section class="card">
            <h2>시스템 제어 및 설정 방법</h2>
            <p>안티-스톡 트레이딩 봇의 제어 및 설정 변경 방법입니다.</p>

            <h3>제어 버튼</h3>
            <ul>
                <li><strong>시작</strong>: 봇이 중지된 상태일 때 트레이딩을 시작합니다.</li>
                <li><strong>중지</strong>: 실행 중인 봇을 즉시 중지합니다. 모든 전략 실행이 멈춥니다.</li>
                <li><strong>설정 적용 및 재시작</strong>: 투자 모드, 거래소 설정, 또는 전략 설정을 변경한 후 이를 반영하기 위해 봇을 재시작합니다. 중지 후 다시 시작하는 것과
                    동일한 효과입니다.</li>
            </ul>

            <h3>설정 변경 워크플로우</h3>
            <ol>
                <li><strong>전략 설정 변경</strong>: '전략 설정' 섹션에서 원하는 전략을 선택하고 파라미터를 수정합니다. <strong>'설정 저장'</strong> 버튼을 누르면
                    파일에 저장됩니다. (즉시 반영되지 않음)</li>
                <li><strong>시스템 설정 변경</strong>: '투자 모드'나 '거래소'를 변경합니다.</li>
                <li><strong>반영</strong>: 변경된 설정을 실제 트레이딩에 적용하려면 반드시 <strong>'설정 적용 및 재시작'</strong> 버튼을 누르거나, 봇을 중지했다가 다시
                    시작해야 합니다.</li>
            </ol>
        </section>

        <section class="card">
            <h2>자동 매매 작동 프로세스 (How it Works)</h2>
            <p>시스템이 어떻게 종목을 찾고 매매하는지 구체적인 예시로 설명합니다.</p>

            <h3>작동 시나리오 예시 (삼성전자)</h3>
            <ol>
                <li><strong>1. 종목 포착 (Scanning)</strong>: <br>
                    스캐너가 시장 전체를 분석하여 거래량이 급증하거나 상위권에 랭크된 '삼성전자'를 발견하고 <strong>감시 리스트(Universe)</strong>에 등록합니다.
                </li>
                <li><strong>2. 실시간 감시 (Monitoring)</strong>: <br>
                    'MarketData' 엔진이 승인된 감시 종목들의 가격을 실시간으로 추적합니다. <br>
                    <em>로그 예시: <code>[감시 종목 업데이트] 총 5개: 005930(삼성전자), ...</code></em>
                </li>
                <li><strong>3. 관심 종목 등극 (Interest)</strong>: <br>
                    '삼성전자'의 일봉 차트가 20일 이동평균선 위에 위치하여 상승 추세임이 확인되면 <strong>관심 종목</strong> 상태가 됩니다.
                    <br><em>로그 예시: <code>[관심 종목 포착] 005930 | 사유: 일봉 상승 추세 진입</code></em>
                </li>
                <li><strong>4. 매수 진입 (Buy Signal)</strong>: <br>
                    5분봉 차트에서 5일선이 20일선을 뚫고 올라가는 <strong>골든크로스</strong>가 발생하고 거래량이 충분하면 즉시 매수합니다.
                    <br><em>로그 예시: <code>[삼성전자] 매수 진입 (골든크로스 + 거래량 충족) ...</code></em>
                </li>
            </ol>
        </section>

        <section class="card">
            <h2>차트 탭 사용 가이드 (Chart Tab)</h2>
            <p>실시간 시세 차트와 매매 내역을 시각적으로 확인하고 분석할 수 있는 공간입니다.</p>

            <h3>1. 차트 조회 및 제어</h3>
            <ul>
                <li><strong>종목코드</strong>: 조회할 종목 코드를 입력합니다. (예: 005930)</li>
                <li><strong>시간 단위 (Timeframe)</strong>: 차트의 캔들 주기를 선택합니다. (1분, 3분, 5분, 15분, 30분, 1시간, 일봉)</li>
                <li><strong>조회 건수 (Lookback)</strong>: 최근 몇 개의 캔들을 불러올지 설정합니다. (기본 300건)</li>
                <li><strong>조회 버튼</strong>: 입력한 설정으로 차트 데이터를 불러옵니다.</li>
            </ul>

            <h3>2. 차트 기능</h3>
            <ul>
                <li><strong>캔들 차트</strong>: 시가, 고가, 저가, 종가를 캔들 형태로 표시합니다. (상승: 초록색, 하락: 빨간색)</li>
                <li><strong>이동평균선 (MA)</strong>: 5, 10, 20, 60, 120, 200일 이동평균선을 체크박스로 켜고 끌 수 있습니다.</li>
                <li><strong>거래량 (Volume)</strong>: 차트 하단에 막대 그래프로 표시됩니다.</li>
                <li><strong>RSI (상대강도지수)</strong>: 차트 최하단에 보라색 선으로 표시됩니다. (과매수/과매도 구간 확인용)</li>
                <li><strong>줌/팬 (Zoom/Pan)</strong>: 마우스 휠로 확대/축소, 드래그로 차트 이동이 가능합니다.</li>
            </ul>

            <h3>3. 매매 내역 (Trade History)</h3>
            <p>차트 하단에 해당 종목의 매매 내역이 리스트로 표시됩니다.</p>
            <ul>
                <li><strong>마커 (Marker)</strong>: 차트 위에 매수(초록색 화살표), 매도(빨간색 화살표) 시점이 표시됩니다.</li>
                <li><strong>날짜 수정</strong>: 매매 내역 테이블의 날짜 입력 필드를 클릭하여 시간을 수정하면, 차트 위의 마커 위치도 즉시 변경됩니다. (디버깅용)</li>
                <li><strong>페이지네이션</strong>: 매매 내역이 많을 경우 하단의 '이전/다음' 버튼으로 페이지를 넘길 수 있습니다.</li>
            </ul>

            <h3>4. 디버그 기능 (Debug Features)</h3>
            <div class="config-item">
                <span class="config-name">테스트 데이터 생성</span>
                <p class="config-desc">가상의 매매 데이터를 생성하여 차트에 표시합니다. (삼성전자 005930 기준)</p>
            </div>
            <div class="config-item">
                <span class="config-name">디버그 마커 (Debug Marker)</span>
                <p class="config-desc">매매 내역의 첫 번째 행에 있는 날짜를 읽어 차트에 'DEBUG' 마커를 표시합니다. 날짜 수정 후 이 버튼을 누르면 수정된 위치에 마커가
                    찍히는지 확인할 수 있습니다.</p>
            </div>
        </section>

        <section class="card">
            <h2>대상 종목 선정 (Target Stock Selection)</h2>
            <p>봇이 거래할 종목을 선정하는 두 가지 방법이 있습니다.</p>

            <h3>1. 수동 지정 (Manual Universe)</h3>
            <p><code>config/strategies.yaml</code> 파일의 <code>universe</code> 리스트에 거래하고 싶은 종목 코드를 직접 입력합니다.</p>
            <div class="config-item">
                <span class="config-name">universe</span>
                <p class="config-desc">거래 대상 종목 코드 리스트입니다.</p>
                <p class="config-example">예시:<br>universe:<br> - "005930" # 삼성전자<br> - "000660" # SK하이닉스</p>
            </div>

            <h3>2. 자동 선정 (Auto-Scanner)</h3>
            <p>시장 상황에 따라 거래량이 터지거나 급등하는 종목을 봇이 자동으로 찾아냅니다. 이 기능을 켜면 수동 지정한 종목은 무시됩니다.</p>
            <div class="config-item">
                <span class="config-name">use_auto_scanner</span>
                <p class="config-desc">자동 선정 기능 사용 여부입니다. (true/false)</p>
            </div>
            <div class="config-item">
                <span class="config-name">scanner_mode</span>
                <p class="config-desc">종목 선정 기준입니다.</p>
                <ul>
                    <li><code>volume</code>: 거래량 상위 종목 (단타/스캘핑에 유리)</li>
                    <li><code>gainers</code>: 등락률 상위 종목 (급등주 공략에 유리)</li>
                </ul>
            </div>
        </section>

        <h2>공통 설정 (Common)</h2>
        <div class="config-item">
            <span class="config-name">risk_pct</span>
            <p class="config-desc">한 번의 거래에 전체 자산 대비 감수할 리스크 비율입니다.</p>
            <p class="config-example">예시: 0.03 (3%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">max_positions</span>
            <p class="config-desc">동시에 보유할 수 있는 최대 종목 수입니다.</p>
            <p class="config-example">예시: 10 (최대 10개 종목 보유)</p>
        </div>

        <h2>이동평균 추세 추종 (MA Trend)</h2>
        <p>일봉상 상승 추세인 종목에서 분봉상 골든크로스가 발생할 때 매수하는 정석적인 추세 추종 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 일봉 20일선 상승 & 종가 > 20일선 (정배열) 상태에서, 5분 이평선이 20분 이평선을 상향 돌파(골든크로스)하고 거래량이 급증할 때.</li>
            <li><strong>청산 ("확정 수익 + 추세 추종" 혼합 전략)</strong>:
                <ol>
                    <li><strong>1차 익절 (Partial TP)</strong>: 수익률이 <code>take_profit1_pct</code> (예: 3%) 도달 시 50% 물량을 즉시
                        매도하여 수익을 확정합니다. (재시작 후에도 상태 유지됨)</li>
                    <li><strong>본전 스탑 (Breakeven Stop)</strong>: 1차 익절 후, 주가가 다시 매수 평균가(본전) 밑으로 떨어지면 남은 물량을 전량 매도하여 손실을
                        방지합니다.</li>
                    <li><strong>트레일링 스탑 (Trailing Stop)</strong>: 주가가 계속 상승하면 매도하지 않고 따라가다가, 고점 대비
                        <code>trail_stop_pct</code> (예: 1.5%) 이상 하락할 때 전량 매도합니다.
                    </li>
                    <li><strong>손절 (Stop Loss)</strong>: 1차 익절 전, 수익률이 <code>-stop_loss_pct</code>에 도달하면 전량 매도합니다.</li>
                </ol>
            </li>
        </ul>
        <div class="config-item">
            <span class="config-name">timeframe</span>
            <p class="config-desc">차트의 시간 단위입니다. (1m, 3m, 5m, 15m, 30m, 1h, 1d)</p>
            <p class="config-example">예시: 5m (5분봉)</p>
        </div>
        <div class="config-item">
            <span class="config-name">vol_k</span>
            <p class="config-desc">평균 거래량 대비 급증 배수입니다.</p>
            <p class="config-example">예시: 1.5 (1.5배 이상)</p>
        </div>
        <div class="config-item">
            <span class="config-name">stop_loss_pct</span>
            <p class="config-desc">손절매 기준 수익률입니다.</p>
            <p class="config-example">예시: 2.0 (2%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">trail_stop_pct</span>
            <p class="config-desc">트레일링 스탑 기준 비율입니다. 고점 대비 이만큼 하락하면 이익 실현/손절합니다.</p>
            <p class="config-example">예시: 1.5 (1.5%)</p>
        </div>

        <h2>볼린저 밴드 평균 회귀 (Bollinger MR)</h2>
        <p>주가가 볼린저 밴드 하단을 이탈했을 때 과매도로 판단하여 매수하고, 평균(중심선)으로 회귀할 때 매도하는 역추세 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 현재가가 볼린저 밴드 하단(Lower Band)의 99% 수준보다 낮아질 때 (밴드 이탈).</li>
            <li><strong>청산</strong>: 중심선(20이평) 위로 올라오면 익절, 또는 손절(-stop_loss_pct) 발생 시.</li>
        </ul>
        <div class="config-item">
            <span class="config-name">risk_pct</span>
            <p class="config-desc">진입 시 자산 대비 리스크 비율입니다.</p>
            <p class="config-example">예시: 0.03 (3%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">stop_loss_pct</span>
            <p class="config-desc">손절매 기준 수익률입니다.</p>
            <p class="config-example">예시: 1.5 (1.5%)</p>
        </div>

        <h2>전고점 돌파 (Breakout)</h2>
        <p>전일 고점을 강하게 돌파하는 종목을 매수하여 단기 상승 추세를 추종하는 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 시가 갭 상승, 전일 고점 돌파, 거래량 급증(평균의 vol_k배) 3박자가 맞을 때.</li>
            <li><strong>청산</strong>: 전일 고점 아래로 다시 하락하거나 손절(-stop_loss_pct) 시 즉시 매도. 목표 수익(take_profit1_pct) 도달 시 절반 익절.
            </li>
        </ul>
        <div class="config-item">
            <span class="config-name">gap_pct</span>
            <p class="config-desc">시가 갭 상승 최소 비율입니다.</p>
            <p class="config-example">예시: 2.0 (2% 이상)</p>
        </div>
        <div class="config-item">
            <span class="config-name">vol_k</span>
            <p class="config-desc">거래량 급증 기준입니다.</p>
            <p class="config-example">예시: 2.0 (2배 이상)</p>
        </div>
        <div class="config-item">
            <span class="config-name">stop_loss_pct</span>
            <p class="config-desc">손절매 기준 수익률입니다.</p>
            <p class="config-example">예시: 2.0 (2%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">take_profit1_pct</span>
            <p class="config-desc">1차 익절(절반 매도) 기준 수익률입니다.</p>
            <p class="config-example">예시: 3.0 (3%)</p>
        </div>

        <h2>VWAP 스캘핑 (VWAP Scalping)</h2>
        <p>거래량 가중 평균 가격(VWAP)을 지지선/저항선으로 활용하여, 주가가 VWAP를 상향 돌파할 때 매수하는 단타 전략입니다.</p>
        <h3>매매 로직</h3>
        <ul>
            <li><strong>진입</strong>: 주가가 VWAP 선을 아래에서 위로 뚫고 올라갈 때 (Cross Up).</li>
            <li><strong>청산</strong>: 주가가 다시 VWAP 아래로 떨어지면 즉시 매도(손절/이탈), 또는 목표 수익(take_profit_pct) 도달 시 익절.</li>
        </ul>
        <div class="config-item">
            <span class="config-name">risk_pct</span>
            <p class="config-desc">스캘핑 전략 전용 리스크 비율입니다.</p>
            <p class="config-example">예시: 0.01 (1%)</p>
        </div>
        <div class="config-item">
            <span class="config-name">take_profit_pct</span>
            <p class="config-desc">목표 수익률입니다.</p>
            <p class="config-example">예시: 1.5 (1.5%)</p>
        </div>
    </div>
</body>

</html>